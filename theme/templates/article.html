{% extends "base.html" %}

{% block meta %}
<meta name="author" content="{{ article.author.name }}" />
<meta name="description" content="{{ article.company }} - {{ article.person }} - {{ article.title }}" />
<meta name="keywords" content="{{ article.tags|join(', ')|escape }}">

{% if article.translations -%}
<link rel="alternate" href="{{ SITEURL }}/{{ article.url }}" hreflang="{{ article.lang }}" />
{% for a in article.translations %}
<link rel="alternate" href="{{ SITEURL }}/{{ a.url }}" hreflang="{{ a.lang }}" />
{% endfor %}
{% endif %}

{% include "partial/og_article.html" %}
{% endblock %}

{% block title %} &ndash; {{ article.title|striptags|escape }}{% endblock %}

{% block content %}
<article class="single">
  <header>
    {% if not ARTICLE_HIDE_TRANSLATION %}
      {% import 'partial/translations.html' as translations with context %}
      {{ translations.translations_for(article) }}
    {% endif %}
    <h1 id="{{ article.slug }}" style="margin-bottom: 10px;">{{ article.title }}</h1>
    <p style="font-size: 1.2em; color: #888; margin-bottom: 20px;">
      {{ article.person }} de {{ article.company }}
    </p>
    <p style="color: #888;">
      {{ _('%(when)s', when=article.locale_date) }}
      {% if PLUGINS and 'post_stats' in PLUGINS %}
        &#8226; {{ _('%(minutes)s min read', minutes=article.stats['read_mins']) }}
      {% endif %}
    </p>
  </header>

  {% if GOOGLE_ADSENSE and GOOGLE_ADSENSE.ads.article_top %}
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="{{ GOOGLE_ADSENSE.ca_id }}"
         data-ad-slot="{{ GOOGLE_ADSENSE.ads.article_top }}"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  {% endif %}

  {# Episode image if exists #}
  {% set episode_date = article.date.strftime('%Y-%m-%d') %}
  <div style="margin: 30px 0;">
    <img src="https://s.danilorca.com/{{ episode_date }}.webp" 
         alt="{{ article.title }}"
         style="width: 100%; max-width: 800px; height: auto; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: block; margin: 0 auto;"
         onerror="this.style.display='none'">
  </div>

  {# Audio player section with HTML5 player #}
  <div style="margin: 30px 0; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
    <h2 style="color: white; text-align: center; margin-top: 0; margin-bottom: 20px; font-size: 1.5em;">Escuchar Episodio</h2>
    <audio controls style="width: 100%; max-width: 800px; display: block; margin: 0 auto; border-radius: 50px; background: rgba(255,255,255,0.9);">
      <source src="{{ article.mp3 }}" type="audio/mpeg">
      Tu navegador no soporta el elemento de audio.
    </audio>
  </div>

  {# YouTube embed if Youtube ID exists #}
  {% if article.youtube_id %}
  <div style="margin: 30px 0;">
    <h2 style="margin-bottom: 20px; text-align: center;">Ver en YouTube</h2>
    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
      <iframe 
        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
        src="https://www.youtube.com/embed/{{ article.youtube_id }}"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
      </iframe>
    </div>
  </div>
  {% endif %}

  {# Tags section #}
  <div style="margin: 30px 0; padding: 20px; background: rgba(255,255,255,0.03); border-radius: 8px;">
    <p style="margin: 0;">
      {% if article.tags %}
        <strong>Tags:</strong>
        {% for tag in article.tags %}
          <a href="{{ SITEURL }}/{{ tag.url }}" style="display: inline-block; padding: 5px 12px; margin: 4px; background: rgba(102, 126, 234, 0.15); border-radius: 20px; text-decoration: none; font-size: 0.9em; transition: background 0.2s;" onmouseover="this.style.background='rgba(102, 126, 234, 0.25)'" onmouseout="this.style.background='rgba(102, 126, 234, 0.15)'">{{ tag }}</a>
        {% endfor %}
      {% endif %}
    </p>
  </div>

  {% if ADD_THIS_ID %}
  <div class="center social-share">
    <p>{{ _('Like this article? Share it with your friends!') }}</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
    <div class="addthis_inline_share_toolbox"></div>
  </div>
  {% endif %}

  {% include "partial/neighbors.html" %}

  {% if article.related_posts %}
  <div class="related-posts">
    <h4>{{ _('You might enjoy') }}</h4>
    <ul class="related-posts">
    {% for related_post in article.related_posts %}
      <li><a href="{{ SITEURL }}/{{ related_post.url }}">{{ related_post.title }}</a></li>
    {% endfor %}
    </ul>
  </div>
  {% elif ADD_THIS_ID %}
    <div class="addthis_relatedposts_inline"></div>
  {% endif %}

  {% if GOOGLE_ADSENSE and GOOGLE_ADSENSE.ads.article_bottom %}
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="{{ GOOGLE_ADSENSE.ca_id }}"
         data-ad-slot="{{ GOOGLE_ADSENSE.ads.article_bottom }}"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  {% endif %}

  {% include "partial/disqus.html" %}
  {% include "partial/isso.html" %}
</article>
{% endblock %}
